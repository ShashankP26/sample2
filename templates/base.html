<!doctype html>
<!--
* Tabler - Premium and Open Source dashboard template with responsive and high quality UI.
* @version 1.0.0-beta20
* @link https://tabler.io
* Copyright 2018-2023 The Tabler Authors
* Copyright 2018-2023 codecalm.net PaweÅ‚ Kuna
* Licensed under MIT (https://github.com/tabler/tabler/blob/master/LICENSE)
-->
{% load static %}
<html lang="en">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<title>Xplabs</title>
	<link rel="icon" href="{% static 'xtitle.jpeg' %}" type="image/x-icon">
	<!-- CSS files -->
	{% load static %}
	<link href="{% static 'css/tabler.min.css' %}" rel="stylesheet" />
	<link href="{% static 'css/tabler-flags.min.css' %}" rel="stylesheet" />
	<link href="{% static 'css/tabler-payments.min.css' %}" rel="stylesheet" />
	<link href="{% static 'css/tabler-vendors.min.css' %}" rel="stylesheet" />
	<link href="{% static 'css/extra.css' %}" rel="stylesheet" />
	<link href="{% static 'css/demo.min.css' %}" rel="stylesheet" />
	<link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.css" />
	<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>



	<style>
		@import url('https://rsms.me/inter/inter.css');

		:root {
			--tblr-font-sans-serif: 'Inter Var', -apple-system, BlinkMacSystemFont, San Francisco, Segoe UI, Roboto, Helvetica Neue, sans-serif;
		}

		body {
			font-feature-settings: "cv03", "cv04", "cv11";
		}

		@media (max-width: 400px) {
			.navbar-brand img {
				width: 100px; /* Reduce logo size */
			}
			
			.navbar-nav {
				flex-wrap: wrap;
				justify-content: space-between;
			}

		}
		@media (max-width: 576px) {
			.not {
				left: 62% !important;
				/* right: auto !important; */
				transform: translateX(-60%) !important;
			}
		}

	</style>
</head>

<body>
	<script src="{% static 'js/demo-theme.min.js' %}"></script>
	<div class="page">
		<!-- Navbar -->
		<header class="navbar navbar-expand-md d-print-none">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu"
					aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<h1 class="navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3">
					<a href="{% url 'home' %}">
						<img src="{% static 'xlogo.png' %}" width="110" height="32" alt="Tabler"
							class="navbar-brand-image">
					</a>
				</h1>
				<div class="navbar-nav flex-row order-md-last">
					<div class=" d-flex">
						<a href="?theme=dark" class="nav-link px-0 hide-theme-dark" title="Enable dark mode"
							data-bs-toggle="tooltip" data-bs-placement="bottom">
							<svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24"
								viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
								stroke-linecap="round" stroke-linejoin="round">
								<path stroke="none" d="M0 0h24v24H0z" fill="none" />
								<path
									d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
							</svg>
						</a>
						<a href="?theme=light" class="nav-link px-0 hide-theme-light" title="Enable light mode"
							data-bs-toggle="tooltip" data-bs-placement="bottom">
							<svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24"
								viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
								stroke-linecap="round" stroke-linejoin="round">
								<path stroke="none" d="M0 0h24v24H0z" fill="none" />
								<path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" />
								<path
									d="M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7" />
							</svg>
						</a>
						<!-- Notification Dropdown -->
						<div class="nav-item dropdown d-flex me-3">
							<a href="#" class="nav-link px-0" data-bs-toggle="dropdown" aria-expanded="false">
								<svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
									<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
									<path d="M10 5a2 2 0 1 1 4 0a7 7 0 0 1 4 6v3a4 4 0 0 0 2 3h-16a4 4 0 0 0 2 -3v-3a7 7 0 0 1 4 -6"/>
									<path d="M9 17v1a3 3 0 0 0 6 0v-1"/>
								</svg>
								<span class="badge bg-red text-white" style="font-size: 0.65rem; padding: 2px 5px;" >{{ unread_count|add:length }}</span>
							</a>

							<!-- Dropdown Menu -->
							<div class=" not dropdown-menu dropdown-menu-end p-0 shadow-lg rounded-3 " style="width: 300px; max-height: 400px; overflow-y: auto;">
								<div class="card border-0">
									<!-- Header -->
									<div class="card-header bg-primary text-white py-2">
										<h5 class="card-title mb-0 d-flex align-items-center">
											<svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
												<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
												<path d="M10 5a2 2 0 1 1 4 0a7 7 0 0 1 4 6v3a4 4 0 0 0 2 3h-16a4 4 0 0 0 2 -3v-3a7 7 0 0 1 4 -6" />
												<path d="M9 17v1a3 3 0 0 0 6 0v-1" />
											</svg>
											Recent Notifications
										</h5>
									</div>
									
									<!-- Notification List -->
									<div class="list-group list-group-flush">
										{% for notification in notifications %}
										<div class="list-group-item d-flex align-items-start">
											<!-- Notification Details -->
											<div class="col ms-2" style="min-width: 0;">
												<a href="{% if notification.title == 'Voucher Paid' %}/website/item_form/{% elif notification.title == 'Your Cash Voucher has been approved' %}'/website/cash_voucher/{% else %}#{% endif %}" class="text-body fw-semibold d-block text-truncate" title="{{ notification.title }}">
													{{ notification.title }}
												</a>
												<div class="text-muted mt-n1">
													<small>{{ notification.message }}</small>
												</div>
											</div>
											<!-- Time -->
											<div class="ms-auto text-muted">
												<small>
													{% if notification.created_at %}
														<sub>{{ notification.created_at|timesince }} ago</sub>
													{% else %}
														No timestamp available
													{% endif %}
												</small>
											</div>
										</div>
										{% endfor %}
									</div>

									<!-- Follow-up Updates Section -->
									<div class="card mt-3">
										<div class="card-header">
											<h5 class="card-title">CRM Notifications</h5>
										</div>
										<div class="list-group list-group-flush list-group-hoverable">
											{% for follow_up in followupss %}
											<div class="list-group-item">
												<div class="row align-items-center">
													<div class="col-auto">
														<span class="status-dot d-block"></span>
													</div>
													<div class="col text-truncate">
														<a href="#" class="text-body d-block">
															{% if follow_up.type == 'confirmed' %}
															<strong>Confirmed: {{ order.enquiry_id }} :</strong> {{ follow_up.foname }}
															{% else %}
															<strong>Enquiry: {{ follow_up.enquiry_id }} :</strong> {{ follow_up.foname }}
															{% endif %}
														</a>
														<div class="d-block text-secondary text-truncate mt-n1">
															Follow-up scheduled for {{ follow_up.fodate }} at {{ follow_up.fotime }}
														</div>
													</div>
												</div>
											</div>
											{% empty %}
											<div class="list-group-item">
												<div class="text-center text-muted">No new follow-ups</div>
											</div>
											{% endfor %}
										</div>
									</div>

									<!-- Footer -->
									<div class="card-footer bg-light text-center py-2">
										<a href="#" class="text-primary text-decoration-none">View All</a>
									</div>
								</div>
							</div>
						</div>


						<!-- User Info Dropdown -->
						<div class="nav-item dropdown d-flex me-3">
							{% if user.is_authenticated %}
							<div class="nav-item dropdown ">
								<a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown"
									aria-label="Open user menu">
									<div class=" d-sm-block ps-2 me-2">
											<div class="fs-2">{{ user.username }} </div>
									</div>
									<span class="avatar avatar-sm"
      										style="background-image: url('{{ user.userprofile.profile_picture.url }}')">
									</span>
								</a>
								<div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
									<div class="card " style="width: 20rem; font-size: 0.9rem;"> <!-- Smaller width and font size -->
										<!-- Card Header -->
										<div class="card-header text-center p-2"> <!-- Reduced padding -->
											<h6 class="card-title mb-0">{{ user.username }}</h6>
										</div>
								
										<!-- Card Body -->
										<div class="card-body p-2"> <!-- Reduced padding -->
											<div class="row">
												<!-- Left Column -->
												<div class="col-6">
													<div class="mb-2">
														<span class="text-muted"><strong>Employee ID:</strong></span>
														<p class="mb-0">{{ user.userprofile.employee_id }}</p>
													</div>
													<div class="mb-2">
														<span class="text-muted"><strong>Email:</strong></span>
														<p class="mb-0">{{ user.userprofile.email }}</p>
													</div>
													<div class="mb-2">
														<span class="text-muted"><strong>Date of Birth:</strong></span>
														<p class="mb-0">{{ user.userprofile.date_of_birth|date:"d M Y" }}</p>
													</div>
												</div>
								
												<!-- Right Column -->
												<div class="col-6">
													<div class="mb-2">
														<span class="text-muted"><strong>Zone:</strong></span>
														<p class="mb-0">
															{% if user.userprofile.zone %}
																{{ user.userprofile.zone.name }}
															{% else %}
																No zone assigned
															{% endif %}
														</p>
													</div>
													<div class="mb-2">
														<span class="text-muted"><strong>Roles:</strong></span>
														<p class="mb-0">
															{% for group in user.groups.all %}
																{{ group.name }}{% if not forloop.last %}, {% endif %}
															{% empty %}
																No role assigned
															{% endfor %}
														</p>
													</div>
													<div class="mb-2">
														<span class="text-muted"><strong>Division:</strong></span>
														<p class="mb-0">
															{% if user.userprofile.division %}
																{{ user.userprofile.division.name }}
															{% else %}
																No division assigned
															{% endif %}
														</p>
													</div>
												</div>
											</div>
								
											<!-- Contact Number (Full Width) -->
											<div class="mt-2">
												<span class="text-muted"><strong>Contact Number:</strong></span>
												<p class="mb-0">{{ user.userprofile.contact_number }}</p>
											</div>
										</div>
								
										<!-- Card Footer with Logout Button -->
										<div class="card-footer text-center p-2"> <!-- Reduced padding -->
											<form method="post" action="{% url 'logout' %}">
												{% csrf_token %}
												<button type="submit" class="btn btn-outline-danger btn-sm w-100">Logout</button>
											</form>
										</div>
									</div>
								</div>
							</div>
							{% else %}
							<div class="nav-item">
								<a class="nav-link text-white" href="{% url 'login' %}">Login</a>
							</div>
							{% endif %}
						</div>
					</div>
				</div>
			</div>
		</header>

		<header class="navbar-expand-md">
			<div class="collapse navbar-collapse" id="navbar-menu">
				<div class="navbar">
					<div class="container-fluid"> <!-- Use container-fluid for full-width on smaller screens -->
						<ul class="navbar-nav">
							<!-- Home Link -->
							<li class="nav-item">
								<a class="nav-link" href="{% url 'home' %}">
									<span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Home Icon -->
										<svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24"
											viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
											stroke-linecap="round" stroke-linejoin="round">
											<path stroke="none" d="M0 0h24v24H0z" fill="none" />
											<path d="M5 12l-2 0l9 -9l9 9l-2 0" />
											<path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
											<path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
										</svg>
									</span>
									<span class="nav-link-title">
										Home
									</span>
								</a>
							</li>

							<!-- Navigation Items (Module Dropdowns) -->
							{% comment %} <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
								<ul class="navbar-nav mx-auto"> {% endcomment %}
									{% for module, visible_submodules in modules_with_submodules.items %}
									<!-- Module: Reports -->
									<li class="nav-item dropdown">
										<a class="nav-link dropdown-toggle" href="#" id="dropdown-{{ module.id }}"
											role="button" data-bs-toggle="dropdown" aria-haspopup="true"
											aria-expanded="false">
											{{ module.name }}
										</a>
										{% if visible_submodules %}
										<div class="dropdown-menu" aria-labelledby="dropdown-{{ module.id }}">
											<!-- Loop through submodules -->
											{% for submodule in visible_submodules %}
											<a class="dropdown-item"
												href="{% url 'submodule_visibility' submodule.slug %}">
												{{ submodule.name }}
											</a>
											{% endfor %}
										</div>
										{% endif %}
									</li>
									{% endfor %}
								{% comment %} </ul>
							</div> {% endcomment %}
							</li>
						</ul>


						
					</div>
				</div>
			</div>
		</header>


		<div class="page-wrapper">

			{% block content %}{% endblock content %}


			<footer class="footer footer-transparent d-print-none">
				<div class="container-fluid">
					<div class="row text-center align-items-center flex-row">
						<div class="col-12 col-lg-auto mt-3 mt-lg-0">
							<ul class="list-inline list-inline-dots mb-0">
								<li class="list-inline-item">
									Copyright &copy; 2024
									<a href="https://xpredictlabs.com/" class="link-secondary"> XpredictLabs</a>.
									All rights reserved.
								</li>
								<li class="list-inline-item">
									v1.0.0-beta20
								</li>
							</ul>
						</div>
					</div>
				</div>
			</footer>
		</div>
	</div>
	<!-- Libs JS -->
	<script src="{% static 'libs/apexcharts/dist/apexcharts.min.js' %}?1692870487" defer></script>
	<script src="{% static 'libs/jsvectormap/dist/js/jsvectormap.min.js' %}?1692870487" defer></script>
	<script src="{% static 'libs/jsvectormap/dist/maps/world.js' %}?1692870487" defer></script>
	<script src="{% static 'libs/jsvectormap/dist/maps/world-merc.js' %}?1692870487" defer></script>
	<!-- Tabler Core -->
	<script src="{% static 'js/tabler.min.js' %}?1692870487" defer></script>
	<script src="{% static 'js/demo.min.js' %}?1692870487" defer></script>
	<script src="{% static 'js/extra.js' %}"></script>
	<script src="{% static 'js/maintenancechecklist.js' %}"></script>
	<script src="{% static 'js/servicereport.js' %}"></script>
	<script src="{% static 'js/generalreport.js' %}"></script>
	<script src="{% static 'js/mom.js' %}"></script>
	<script src="https://cdn.datatables.net/2.1.8/js/dataTables.js"></script>
	<!-- Include jQuery (required for Bootstrap 4) -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<!-- Include Bootstrap JS -->
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>

	{% block extra_scripts %}{% endblock extra_scripts %}
</body>

</html>